<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Color Experiment 2: JS Complementary</title>
    <style>
      body {
        font-family: system-ui, -apple-system, sans-serif;
        padding: 2rem;
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }
      .color-box {
        padding: 20px;
        border: 1px solid #ccc;
        max-width: 300px;
        border-radius: 8px;
        transition: background-color 0.1s, color 0.1s;
      }
    </style>
  </head>
  <body>
    <h1>Experiment 2: JS Complementary</h1>
    <p>Technique: JavaScript Hue Rotation (180Â°)</p>
    <p>
      This technique calculates the complementary color by converting HEX to
      HSL, rotating the Hue by 180 degrees, and converting back to CSS HSL
      string.
    </p>

    <input type="color" id="colorPicker" value="#ff0000" />

    <div id="colorBox" class="color-box">
      Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod
      tempor incididunt ut labore et dolore magna aliqua.
    </div>

    <script>
      const colorPicker = document.getElementById("colorPicker");
      const colorBox = document.getElementById("colorBox");

      const getComplementaryColor = (() => {
        function hexToHSL(hex) {
          // Remove # if present
          hex = hex.replace(/^#/, "");

          // Parse r, g, b
          let r = parseInt(hex.substring(0, 2), 16) / 255;
          let g = parseInt(hex.substring(2, 4), 16) / 255;
          let b = parseInt(hex.substring(4, 6), 16) / 255;

          let max = Math.max(r, g, b),
            min = Math.min(r, g, b);
          let h,
            s,
            l = (max + min) / 2;

          if (max === min) {
            h = s = 0; // achromatic
          } else {
            let d = max - min;
            s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
            switch (max) {
              case r:
                h = (g - b) / d + (g < b ? 6 : 0);
                break;
              case g:
                h = (b - r) / d + 2;
                break;
              case b:
                h = (r - g) / d + 4;
                break;
            }
            h /= 6;
          }

          return { h: h * 360, s: s * 100, l: l * 100 };
        }

        return function getComplementaryColor(hex) {
          const hsl = hexToHSL(hex);
          // Rotate hue by 180 degrees to get complementary color
          const newHue = (hsl.h + 180) % 360;
          // Keep saturation and lightness the same (or adjust for better contrast if needed)
          // For better readability, we might want to ensure lightness is distinct from background
          // But for pure "mathematically opposite" in hue:
          return `hsl(${newHue}, ${hsl.s}%, ${hsl.l < 50 ? 90 : 10}%)`;
          // Note: I added a lightness check above because pure hue rotation
          // on 50% gray is still 50% gray (low contrast).
          // So I force high/low lightness for readability while keeping the complementary hue.
        };
      })();

      colorPicker.addEventListener("input", (event) => {
        const color = event.target.value;
        console.log("Current color:", color);

        colorBox.style.backgroundColor = color;

        // Calculate and apply text color
        const textColor = getComplementaryColor(color);
        colorBox.style.color = textColor;
        console.log("Text color:", textColor);
      });

      // Trigger on load
      colorPicker.dispatchEvent(new Event("input"));
    </script>
  </body>
</html>
